# C/C++ 模块边界与依赖分析注意点

> **阅读时机**：执行 Skill 02 任务 1（识别模块）或任务 3（解析依赖方向）时，按需查阅。

---

## 目的

在复杂 C/C++ 工程中，模块边界与依赖除目录和构建 target 外，还受命名空间、头文件与实现分离、链接方式等影响。本约定供 Agent 在模块识别与依赖分析时做补充校验，避免漏掉关键依赖或误把实现细节当独立模块。

---

## 模块边界

- **命名空间**：C++ 中可按命名空间划分逻辑模块；若目录与命名空间不一致，以「对外暴露的命名空间」或「构建 target」为主，在模块报告中注明命名空间范围。
- **头文件与实现分离**：同一模块可能包含 `include/` 下头文件与 `src/` 下实现；模块路径/范围应同时覆盖二者，或在报告中写明「公开接口路径」与「实现路径」。
- **静态/动态链接边界**：若工程产出静态库/动态库，库边界通常对应模块边界；注意 `-static`、`SHARED`/`STATIC` 等配置，避免将同一逻辑模块拆成多份。

---

## 依赖分析

- **#include 与物理依赖**：除 `#include` 外，注意前向声明、PIMPL、接口与实现分离带来的「逻辑依赖 vs 编译依赖」差异；在依赖表中可区分「直接编译依赖」与「运行时/逻辑依赖」。
- **ABI 相关目录**：若存在 ABI 兼容层、版本化符号目录，将其视为独立模块或隶属于某核心模块，在报告中注明，便于后续重构时评估影响面。

---

## 在报告中的体现

- 模块报告的 **路径/范围** 可写为多行，例如：`include/foo/`、`src/foo/`。
- **外部依赖** 中可区分「C 标准库」「C++ 标准库」「第三方库（含链接方式）」。
- 不确定处标注「待确认」，避免臆断。

---

**下一步**：返回 [Skill 02](1-code-cognition/skills/skill-02-modules.md) 继续任务 1 或任务 3。
