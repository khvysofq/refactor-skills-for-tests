# 模块复杂度等级定义

> **阅读时机**：进行模块复杂度评级时（执行 Skill 02 或 Phase 02 时）。

---

## 等级概览

| 等级 | 名称 | 典型特征                               |
| ---- | ---- | -------------------------------------- |
| 低   | 低   | 代码量小、依赖少、无外部 I/O/线程/硬件 |
| 中   | 中   | 中等规模或少量外部依赖                 |
| 高   | 高   | 大量依赖、多外部系统、并发/状态多      |
| 极高 | 极高 | 跨进程/硬件/强非确定性或历史债重       |

---

## 判定维度

对每个模块综合以下维度打分，再映射到上述等级：

### 1. 代码规模

| 规模 | 行数（参考） | 得分影响 |
| ---- | ------------ | -------- |
| 小   | < 500        | 降一档   |
| 中   | 500–3000     | 中性     |
| 大   | 3000–10000   | 升一档   |
| 超大 | > 10000      | 升两档   |

### 2. 内部依赖数量

- **少**：直接依赖 ≤ 3 个模块 → 中性或降一档
- **中**：4–8 个模块 → 中性
- **多**：> 8 个模块 → 升一档

### 3. 外部依赖类型

| 类型          | 示例                         | 影响         |
| ------------- | ---------------------------- | ------------ |
| 无/仅标准库   | 无文件/网络/时间/线程        | 中性或降一档 |
| I/O           | 文件、管道、标准流           | 升一档       |
| 时间/随机     | time, clock, rand            | 升一档       |
| 网络          | socket, HTTP, RPC            | 升一档       |
| 线程/并发     | pthread, std::thread, mutex  | 升一档       |
| 全局状态/单例 | static, extern, ::instance() | 升一档       |
| 硬件/SDK      | 厂商库、驱动接口             | 升两档       |

多种类型并存时可按叠加效果升档。

### 4. 控制流与结构复杂度

- 单一路径、无深层嵌套 → 中性
- 多分支、多错误路径、状态机 → 升一档
- 回调/异步/事件驱动、难以线性阅读 → 升一档

### 5. 历史债与可读性

- 注释少、命名混乱、魔法数多、强耦合 → 可额外升一档

---

## 等级映射规则

1. 从**中**起步，按上述维度调整。
2. 任一维度达到「升两档」或多个「升一档」→ 至少**高**；若同时有硬件/跨进程/强非确定性 → **极高**。
3. 所有维度均偏简单 → **低**。
4. 不确定时优先选**中**或**高**，并在模块报告中注明「评级依据简要说明」。

---

## 在模块报告中的填写

在 [模块报告](1-code-cognition/templates/module-report.md) 的「复杂度评级」一节中：

- 填写最终等级：**低 / 中 / 高 / 极高**
- 可选：用一句话说明主要依据（如「依赖 6 个内部模块 + 文件与网络 I/O」）

---

**下一步**：返回调用此文档的 [Skill 02](1-code-cognition/skills/skill-02-modules.md) 或 [Phase 02](1-code-cognition/phases/02-modules.md)，完成模块报告中的复杂度评级。
