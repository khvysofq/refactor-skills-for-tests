# Phase 01: 工程基线与门禁准备

> **前置条件**：无  
> **目标**：建立可重复执行的构建和测试基础设施

---

## 进入条件

从 [Workflow.md](../Workflow.md.md) 决策树判断需要执行此阶段。

---

## 执行指令

**加载 Skill**：阅读并执行 → [Skill 01: 工程基线与门禁准备](../skills/skill-01-baseline.md)

---

## 阶段验收标准

在 Skill 01 完成后，验证以下条件全部满足：

### 必须满足

- [ ] **构建验证**：核心 target 编译成功
  ```bash
  # 执行构建命令，确认返回 0
  # 示例：make / cmake --build . / bazel build //...
  ```

- [ ] **测试骨架**：`tests/` 目录结构存在
  ```bash
  ls -la tests/
  # 应看到测试目录结构
  ```

- [ ] **测试运行器**：能执行并返回 0
  ```bash
  # 执行测试命令，确认返回 0（即使只有 dummy test）
  # 示例：ctest / make test / ./tools/test.sh
  ```

- [ ] **门禁命令**：一键命令可重复执行
  ```bash
  # 连续执行 2 次，确认结果一致
  ./tools/test.sh && ./tools/test.sh
  ```

### 可选但推荐

- [ ] 生成 `compile_commands.json`
- [ ] CI 配置文件存在
- [ ] Sanitizer 构建配置可用

---

## 阶段产出物

| 产出 | 路径 | 说明 |
|------|------|------|
| 测试目录 | `tests/` | 测试文件存放位置 |
| 门禁脚本 | `tools/test.sh` 或等效 | 一键构建+测试 |
| CI 配置 | `.github/workflows/` 或等效 | 可选 |
| 编译数据库 | `compile_commands.json` | 可选 |

---

## 完成后跳转

| 验收结果 | 下一步 |
|----------|--------|
| 通过 | 进入 [Phase 02: 工程分析](02-analysis.md) |
| 未通过 | 返回 Skill 01 继续修复 |

---

## 常见问题

### Q: 构建依赖缺失怎么办？

**A**: 1. 分析缺失的依赖 → 2. 安装系统依赖（apt/yum/brew）或配置第三方库路径 → 3. 重试构建

### Q: 现有测试框架与推荐不同？

**A**: 优先使用项目现有框架，不强制更换。只需确保测试运行器能正常工作即可。

### Q: 没有 CI 环境？

**A**: 本地门禁脚本足够，CI 为可选项。关键是有可重复的验证手段。

---

## 时间预估

| 场景 | 预估时间 |
|------|----------|
| 构建系统完善 | 0.5-1 小时 |
| 构建系统需修复 | 2-4 小时 |
| 需要引入测试框架 | 1-2 小时 |

---

**执行**：立即加载 [Skill 01](../skills/skill-01-baseline.md) 开始执行
